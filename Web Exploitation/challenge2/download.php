<?php
if (isset($_GET['file'])) {
    $file = $_GET['file'];
    
    // Attempt to look secure by checking if file contains 'course'
    if (strpos($file, 'course') !== false) {
        // Vulnerable! No proper path sanitization
        $filepath = "materials/" . $file;
        
        // Check if file exists
        if (file_exists($filepath)) {
            header('Content-Type: application/pdf');
            header('Content-Disposition: attachment; filename="' . basename($filepath) . '"');
            readfile($filepath);
            exit;
        }
    }
}
echo "File not found";
